<!DOCTYPE html>
<script src="/jquery.min.js"></script>
<!--<script src="/main.js"></script>-->
<link rel="shortcut icon" href="/logo.svg" type="image/svg+xml" />
<link rel="stylesheet" href="/package.css" />
<link rel="stylesheet" href="/rainbow.css" />
<script src="/marked.js"></script>
<script src="/rainbow.js"></script>
<title>As-Bitray | AssemblyScript</title>

<body>
  <div class="navbar">
    <img class="navbar-logo" src="/logo.svg" height: 40px; wclassth: 40px;>
    <div class="navbar-logoText">
      AssemblyScript
      <div class="navbar-logoSubText">Packages</div>
    </div>
    <textarea class="searchText" placeholder="Search for packages"></textarea>
    <div class="navbar-content">
      <a
        class="navbar-packages"
        href="https://assemblyscript.org/packages/"
        rel="nofollow"
        >Packages</a
      >
      <a class="navbar-about" href="https://assemblyscript.org/" rel="nofollow"
        >About</a
      >
      <a
        class="navbar-docs"
        href="https://assemblyscript.org/introduction.html"
        rel="nofollow"
        >Docs</a
      >
      <a
        class="navbar-publish"
        href="https://assemblyscript.org/"
        rel="nofollow"
        >Publish</a
      >
    </div>
  </div>
  <div class="readme"></div>
</body>
<script>
  $(document).ready(async () => {
    const currentPackage =
      window.location.href.split("/package")[1]?.replace("/", "") || "";
    const fetched = await fetch(
      `http://localhost:3000/readme?name=${currentPackage}`
    );
    const pkg = await fetch(
      `http://localhost:3000/info?name=${currentPackage}`
    );
    let body = await fetched.text();
    let pkgData = JSON.parse(await pkg.text());
    let html = marked(body);
    html = html.replaceAll("<img", '<img class="readmeImg"');
    $(".readme").html(`
        <div style="padding-left: 30px;">
					<a href="${pkgData.npm}"><input type="image" src="/npm.png" class="NPMlogo"></input></a>
					<a href="${pkgData.github}"><input type="image" src="/github.png" class="GitHublogo"></input></a>
				${html}</div>`);

    const blocksJS = document.getElementsByClassName("language-js");

    for (let i = 0; i < blocksJS.length; i++) {
      let element = blocksJS.item(i);
      Rainbow.color(element.textContent, "javascript", (code) => {
        console.log("\nColored Code:\n", code);
        element.innerHTML = code;
      });
    }

    const blocksBash = document.getElementsByClassName("language-bash");

    for (let i = 0; i < blocksBash.length; i++) {
      let element = blocksBash.item(i);
      Rainbow.color(element.textContent, "bash", (code) => {
        console.log("\nBash Code:\n", code);
        element.innerHTML = code;
      });
    }
  });
</script>
